<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>线性基</title>
  <link rel="stylesheet" type="text/css" id="frame_style" href="../css/frame_style1.css">
  <link rel="stylesheet" type="text/css" id="Markdown_style" href="../css/Markdown_style.css">
  <script type="text/javascript" src="../jscode/frame.js"></script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <link rel="stylesheet" href="https://ziyuan.fenxianglu.cn/js/highlight/styles/default.css">
  <script src="https://ziyuan.fenxianglu.cn/js/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
</head>
<body>
  <div class="main">
    <div class="head">
      <div class="title1">
        <a href="../index.html">wjh15101051's space</a>
      </div>
      <div class="title2">
        卧薪尝胆，厚积薄发。
      </div>
    </div>
    <div id="middle_blogfile">
      <div class="blog_blogfile">
        <div class="blogfile_title">
            线性基
        </div>
        <div class="blogfile_stitle">
          <img src="http://pic.yupoo.com/wjh15101051/1e0e1b3a/118165c5.jpg">
          Date: Sat Jun 30 23:17:17 CST 2018
          <img src="http://pic.yupoo.com/wjh15101051/2ea96b56/7882c4ab.png">
          In Category:
          <a href="../categories/总结.html">总结</a>
        </div>
        <div class="blogfile_content">
<div class = "MarkdownCommonContent">
</div>
<div class = "MarkdownCommonContent">
<h2 class = "MarkdownH2">
线性表出
</h2>
</div>
<div class = "MarkdownCommonContent">
对于一个空间中的向量来说，如果向量集合中的一些向量只进行加法和数乘运算可以得到另一个向量，则称这个向量可以由这个集合中的向量
<strong class = "MarkdownStrong">
线性表出
</strong>
。如果一组向量中任意一个向量都不能被其他向量线性表出，则称这一组向量
<strong class = "MarkdownStrong">
线性无关
</strong>
，否则成为
<strong class = "MarkdownStrong">
线性相关
</strong>
。
</div>
<div class = "MarkdownCommonContent">
<h2 class = "MarkdownH2">
线性空间的基
</h2>
</div>
<div class = "MarkdownCommonContent">
如果一个线性空间可以由一组向量
<strong class = "MarkdownStrong">
张成
</strong>
，并且这一组向量线性无关，则称这一组向量是线性空间的一个
<strong class = "MarkdownStrong">
基
</strong>
，基中的向量个数叫做这个向量空间的
<strong class = "MarkdownStrong">
维度
</strong>
。基的任何子集都不能张成原向量空间，原向量空间可以有多个基，每个基中向量个数相同。
<strong class = "MarkdownStrong">
原线性空间的一个向量可以由基中的向量唯一表出
</strong>
。
</div>
<div class = "MarkdownCommonContent">
<h2 class = "MarkdownH2">
异或线性基
</h2>
</div>
<div class = "MarkdownCommonContent">
将每个数的二进制表示看作向量构成的向量空间的基。
</div>
<div class = "MarkdownCommonContent">
基中元素张成的空间等价于原空间，即基中的数相互异或形成的集合等价于原数相互异或形成的集合。
</div>
<div class = "MarkdownCommonContent">
线性基二进制最高位互不相同。一个满的线性基（每一位都有数）表示的异或集合为
$[1,2^n-1]$
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
维护
</h3>
</div>
<div class = "MarkdownCommonContent">
维护一个上三角矩阵，即最高位互不相同。
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
插入
</h3>
</div>
<div class = "MarkdownCommonContent">
对于这个数的是一的每一位，判断在原线性基中这一位是否有数，如果没有，就把这个数加到线性基的这一位，如果有，就把这一位上的一消掉，也就是说始终保持比当前位高的位均为
$0$
，这样插入时仍能保证上三角矩阵。
</div>
<div class = "MarkdownCommonContent">
注意要打一个
$tag$
标记表示异或线性基能否组合出
$0$
。能组合出
$0$
当且仅当有一个数在插入时被削成了
$0$
。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
void insert(ll a)<br />
{<br />
	for(int i = BASE;i &gt;= 0;--i)<br />
	{<br />
		if(a & (1ll &lt;&lt; i))<br />
		{<br />
			if(d[i] == 0)<br />
			{<br />
				++cnt;<br />
				d[i] = a;<br />
				break;<br />
			}<br />
			else a ^= d[i];<br />
		}<br />
	}<br />
	if(a == 0)tag = true;<br />
	return;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
查询异或最大值
</h3>
</div>
<div class = "MarkdownCommonContent">
由于最高位各不相同且任意两个基相互不影响，故查询满足贪心性质，逐位考虑如果异或上这个基可以使结果更大，就把这位异或上。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
ll query_max()<br />
{<br />
	ll res = 0ll;<br />
	for(int i = BASE;i &gt;= 0;--i)<br />
	{<br />
		if((res ^ d[i]) &gt; res)res ^= d[i];<br />
	}<br />
	return res;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
查询异或最小值
</h3>
</div>
<div class = "MarkdownCommonContent">
如果
$tag$
为真，则最小值是
$0$
。否则由线性基的性质可知最小值为最小的那个线性基。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
ll query_min()<br />
{<br />
	if(tag)return 0;<br />
	for(int i = 0;i &lt;= BASE;++i)<br />
	{<br />
		if(d[i])return d[i];<br />
	}<br />
	return 0;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
查询第
$k$
小值
</h3>
</div>
<div class = "MarkdownCommonContent">
先把能消掉的位都削成
$0$
，保证每一次异或操作都能得出更大的答案，存储到一个数组里。注意数组循环的方向，从
$0$
位开始填数。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
void prepare()<br />
{<br />
	int tot = 0;<br />
	memset(p,0,sizeof(p));<br />
	for(int i = BASE;i &gt;= 0;--i)<br />
	{<br />
		for(int j = i - 1;j &gt;= 0;--j)<br />
		{<br />
			if(d[i] & (1ll &lt;&lt; j))<br />
			{<br />
				d[i] ^= d[j];<br />
			}<br />
		} <br />
	}<br />
	for(int i = 0;i &lt;= BASE;++i)<br />
	{<br />
		if(d[i])<br />
		{<br />
			p[tot++] = d[i];<br />
		}<br />
	}<br />
	return;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
然后先判断异或集合中是否存在
$0$
，如果存在，则
$--k$
，由于线性基中的数最高位都不同，所以共能组成
$2^n-1$
个数，由二进制的性质可得以第
$i$
大的线性基开头的数由
$2^{i-1}$
个（后
$i-1$
个线性基可以随意组合），于是逐位考虑
$k$
的每个二进制位，如果这位是一，就说明有
$2^{i-1}$
个比他小的，于是答案就异或上第
$i$
个线性基。类似数位
$DP$
。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
ll query_kth(ll k)<br />
{<br />
	if(tag){--k;}<br />
	ll res = 0;<br />
	if(k &gt;= (1ll &lt;&lt; cnt))return -1;<br />
	for(int i = BASE;i &gt;= 0;--i)<br />
	{<br />
		if(k & (1ll &lt;&lt; i))<br />
		{<br />
			res = res ^ p[i];<br />
		}<br />
	}<br />
	return res;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
<h3 class = "MarkdownH3">
查询
$k$
的排名
</h3>
</div>
<div class = "MarkdownCommonContent">
查询数字
$k$
再张成的集合中排名第几。
</div>
<div class = "MarkdownCommonContent">
对于一个再张成集合中的数，他一定出现了
$2^{n-cnt}$
次，因为有
$n-cnt$
个向量被线性表出了，它们之间可以任意组合一定还能找到一组基底使得异或出这个数。还是先
$prepare$
，不过略有不同，如果第
$i$
位线性基上有值，那么就能组合出以他为开头的
$2^{i-1}$
个数，所以先把所有有数的线性基找出来并记下位数。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
void prepare()<br />
{<br />
	tot = 0;<br />
	memset(p,0,sizeof(p));<br />
	for(int i = 0;i &lt;= BASE;++i)<br />
	{<br />
		if(d[i])<br />
		{<br />
			p[tot++] = i;<br />
		}<br />
	}<br />
	return;<br />
}<br />
</pre></code>
</div>
<div class = "MarkdownCommonContent">
对于一个查询的
$k$
，如果线性基
$i$
位数为
$j$
，且
$k$
第
$j$
位上有值，那么就有了
$2^j$
个数比他小，故
$ans+=2^j$
，最后由于每个数都出现了
$2^{n-cnt}$
次，再乘上即可。
</div>
<div class = "MarkdownCommonContent">
<pre><code class="MarkdownParaCode">
ll query_krank(ll k)<br />
{<br />
	int res = 0;<br />
	for(int i = 0;i &lt; tot;++i)<br />
	{<br />
		if(k & (1ll &lt;&lt; p[i]))<br />
		{<br />
			res += (1 &lt;&lt; i);<br />
			res %= MOD;<br />
		}<br />
	}<br />
	res = (res * power(2,n - cnt) % MOD + 1) % MOD;<br />
	return res;<br />
}<br />
</pre></code>
</div>
        </div>
        <div class="blogfile_showtag">
          <img src="http://pic.yupoo.com/wjh15101051/2380cc18/89ee2c05.png">
          In tag:

          <!--<a href="../tags/blog.html">blog</a>-->
        </div>
      </div>
    </div>
    <div id="middle_nav">
      <div class="blog_host">
        <div class="nav_avator">
          <img src="http://pic.yupoo.com/wjh15101051/72c1aeab/f51d56e0.jpg" alt="avator">
        </div>
        <div class="nav_ID">
          wjh15101051
        </div>
      </div>
      <div class="nav_list">
        <li class="tags">
          <a href="../tags.html">
            <img src="http://pic.yupoo.com/wjh15101051/2380cc18/89ee2c05.png" class="list_icon" id="tags_image">
            Tags
          </a>
        </li>
        <li class="categories">
          <a href="../categories.html">
            <img src="http://pic.yupoo.com/wjh15101051/2ea96b56/7882c4ab.png" class="list_icon" id="categories_image">
            Categories
          </a>
        </li>
        <li class="timeline">
          <a href="../timeline.html">
            <img src="http://pic.yupoo.com/wjh15101051/30365cc7/c1a3be15.png" class="list_icon" id="timeline_image">
            Timeline
          </a>
        </li>
        <li class="about">
          <a href="../about.html">
            <img src="http://pic.yupoo.com/wjh15101051/24f1cb41/e239086e.png" class="list_icon" id="about_image">
            About
          </a>
        </li>
        <li class="toolbox">
          <a href="../toolbox.html">
            <img src="http://pic.yupoo.com/wjh15101051/dee9f673/d3cf682a.png" class="list_icon" id="toolbox_image">
            Toolbox
          </a>
        </li>
        <li class="friends">
            <div class="friends_text">
              <img src="http://pic.yupoo.com/wjh15101051/d291ebed/29f9c807.png" id="friends_image">
              Friends
            </div>
            <div id="fp_friends_list">
              <div id="SGcolin">
                <a href="http://blog.gyx.me/" target="_blank">SGcolin</a>
              </div>
              <div id="Xingcy">
                <a href="https://www.cnblogs.com/xcysblog/" target="_blank">Xingcy</a>
              </div>
              <div id="ZH_comld">
                <a href="https://www.cnblogs.com/ZH-comld/" target="_blank">ZH_comld</a>
              </div>
            </div>
            <br>
          </div>
        </li>
      </div>
    <div class="music_player">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
      <script src="https://blog-static.cnblogs.com/files/yjlaugus/APlayer.min.js"></script>
      <div id="aplayer" class="aplayer"  data-id="5313691453" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#F58EA8"></div>
      <script src="https://unpkg.com/meting@1.2/dist/Meting.min.js"></script>
    </div>
    <div class="bottom">
      <div>
        Copyright © 2020
        <a id="copyright_user_a" href="index.html">
          <span id="copyright_user">wjh15101051</span>
        </a>
      </div>
      <div class="bottom_anime">ღゝ◡╹)ノ♡</div>
    </div>
  </div>
</body>
</html>
